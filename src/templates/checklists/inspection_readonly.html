{% extends 'base_admin.html' %}

{% block title %}–û—Ç—á–µ—Ç #{{ inspection.id }}{% endblock %}

{% block content %}
<div class="container pb-5" style="max-width: 900px;">

    <!-- –®–∞–ø–∫–∞ –æ—Ç—á–µ—Ç–∞ -->
    <div class="d-flex justify-content-between align-items-center mb-4 border-bottom pb-3">
        <div>
            <h6 class="text-muted text-uppercase">–û—Ç—á–µ—Ç –æ –ø—Ä–æ–≤–µ—Ä–∫–µ #{{ inspection.id }}</h6>
            <h2 class="mb-2">{{ inspection.template.name }}</h2>
            <div class="text-muted">
                üìÖ –î–∞—Ç–∞: <strong>{{ inspection.date_check|date:"d.m.Y" }}</strong> <br>
                üìç –£—á–∞—Å—Ç–æ–∫: <strong>{{ inspection.location_snapshot }}</strong> <br>
                üë§ –ò–Ω—Å–ø–µ–∫—Ç–æ—Ä: <strong>{{ inspection.inspector.first_name }} {{ inspection.inspector.last_name }}</strong>
            </div>
        </div>
        <div>
            <!-- –ö–Ω–æ–ø–∫–∞ –ø–µ—á–∞—Ç–∏ (–ë–æ–Ω—É—Å) -->
            <button onclick="window.print()" class="btn btn-outline-secondary">üñ® –ü–µ—á–∞—Ç—å</button>
            <a href="{% url 'admin_history' %}" class="btn btn-primary ms-2">–ù–∞–∑–∞–¥ –≤ –∂—É—Ä–Ω–∞–ª</a>
        </div>
    </div>

    <!-- –¢–µ–ª–æ –æ—Ç—á–µ—Ç–∞ -->
    {% for section_name, items in sections_data.items %}
        <div class="card mb-4 shadow-sm border-0">
            <div class="card-header bg-light fw-bold text-dark">
                {{ section_name }}
            </div>
            <div class="card-body p-0">
                {% for item in items %}
                    <div class="p-3 border-bottom d-flex gap-3 align-items-start bg-opacity-10 {% if item.is_compliant %}bg-success{% else %}bg-danger{% endif %}">

                        <!-- –°—Ç–∞—Ç—É—Å (–ò–∫–æ–Ω–∫–∞) -->
                        <div class="flex-shrink-0" style="font-size: 1.5rem;">
                            {% if item.is_compliant %}
                                <i class="bi bi-check-circle-fill text-success"></i>
                            {% else %}
                                <i class="bi bi-x-circle-fill text-danger"></i>
                            {% endif %}
                        </div>

                        <!-- –ö–æ–Ω—Ç–µ–Ω—Ç -->
                        <div class="flex-grow-1">
                            <div class="fw-medium mb-1">{{ item.criteria_text }}</div>

                            <!-- –ï—Å–ª–∏ –µ—Å—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π -->
                            {% if item.comment %}
                                <div class="alert alert-warning py-1 px-2 d-inline-block mb-1 small">
                                    üí¨ {{ item.comment }}
                                </div>
                            {% endif %}

                            <!-- –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ -->
                            {% if item.photos.all %}
                                <div class="d-flex flex-wrap gap-2 mt-2">
                                    {% for photo in item.photos.all %}
                                        <a href="{{ photo.image.url }}" target="_blank">
                                            <img src="{{ photo.image.url }}" class="rounded border bg-white"
                                                 style="width: 100px; height: 100px; object-fit: cover;">
                                        </a>
                                    {% endfor %}
                                </div>
                            {% endif %}
                        </div>

                    </div>
                {% endfor %}
            </div>
        </div>
    {% endfor %}

    <div class="text-center text-muted mt-5">
        –î–æ–∫—É–º–µ–Ω—Ç —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∏—Å—Ç–µ–º–æ–π CheckSystem.
    </div>

</div>
{% endblock %}
